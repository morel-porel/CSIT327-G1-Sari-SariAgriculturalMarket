{% extends 'base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/consumer_profile.css' %}">
<link rel="stylesheet" href="{% static 'css/loyalty_rewards.css' %}">

<div class="profile-page-wrapper">

    <div class="profile-grid-layout">

        <!-- BACK BUTTON (full width on top) -->
        <div class="grid-column" style="grid-column: span 3; margin-bottom: -10px;">
            <a href="{% url 'profile' %}" class="back-link">‚Üê Back to Profile</a>
            <h1 class="page-title">Loyalty Rewards</h1>
        </div>

        <!-- MAIN CONTENT ‚Äì CENTER COLUMN ONLY -->
        <div class="grid-column" style="grid-column: span 3; max-width: 900px; margin:auto;">

            <!-- POINTS CARD -->
            <div class="modern-card loyalty-main-card">

                <div class="loyalty-card-flex">

                    <div class="loyalty-info">
                        <h2 class="title">Your Points Balance</h2>

                        <p class="loyalty-points">{{ loyalty.points }}</p>
                        <p class="points-label">Total Points</p>

                        <p class="progress-msg">
                            {% if next_tier %}
                                Earn <strong>{{ points_needed }}</strong> more points to reach <strong>{{ next_tier }}</strong> tier
                            {% else %}
                                You reached the highest tier! üéâ
                            {% endif %}
                        </p>

                        <!-- PROGRESS BAR -->
                        <div class="progress-wrapper">
                            <div class="progress-bar-fill" style="width: {{ progress_percentage }}%;"></div>
                        </div>
                    </div>

                    <div class="perks-box">
                        <img src="{% static 'images/logo.png' %}" class="perk-img">
                        <p class="perk-text">Exclusive<br>Member<br>Perks</p>
                    </div>

                </div>
            </div>

            <!-- EARN POINTS -->
            <div class="modern-card">
                <div class="card-header no-border">
                    <h3>Earn Points</h3>
                </div>
                <div class="card-body">
                    <p>‚Ä¢ Message vendor for the first time <strong>+20</strong></p>
                    <p>‚Ä¢ Unique product search <strong>+5</strong></p>
                </div>
            </div>

            <!-- REDEEM REWARDS -->
            <div class="modern-card">
                <div class="card-header no-border">
                    <h3>Redeem Rewards</h3>
                </div>

                <div class="card-body">
                    <form method="POST" action="{% url 'redeem_points' %}">
                        {% csrf_token %}

                        <select name="reward" class="reward-dropdown">
                            <option value="5% Discount|150">5% Discount ‚Äì 150 points</option>
                            <option value="Free Delivery|300">Free Delivery ‚Äì 300 points</option>
                            <option value="VIP Badge|700">VIP Badge ‚Äì 700 points</option>
                        </select>

                        <button type="submit" class="btn-redeem">
                            Redeem
                        </button>
                    </form>
                </div>
            </div>

        </div>
    </div>
</div>

{% endblock %}
